import base64,codecs
main = "aW1wb3J0IHJlcXVlc3RzCmltcG9ydCBzeXMsIHRpbWUKaW1wb3J0IGNvbGxlY3Rpb25zCmltcG9ydCByZSBhcyByCgpudSA9ICJcMDMzWzBtIgpyZSA9ICJcMDMzWzE7MzFtIgpnciA9ICJcMDMzWzA7MzJtIgpjeSA9ICJcMDMzWzA7MzZtIgp3aCA9ICJcMDMzWzA7MzdtIgp5ZSA9ICJcMDMzWzA7MzRtIgoKc3UgPSBmIlwwMzNbMTszMW1bXDAzM1sxOzM2bStcMDMzWzE7MzFtXXtudX0iCmZhID0gZiJcMDMzWzE7MzFtW1wwMzNbMTszMW0hXDAzM1sxOzMxbV17bnV9IgplciA9IGYiXDAzM1sxOzMxbVtcMDMzWzE7MzRtP1wwMzNbMTszMW1de251fSIKCiMgMzAtMzMsIDQ4LTUwLCA5NC05NiwgMTk1LTIxMAoKZGVmIHVybHNob3J0bmVyKHVybCk6CiAgICBkYXRhID0gcmVxdWVzdHMuZ2V0KCJodHRwOi8vdGlueXVybC5jb20vYXBpLWNyZWF0ZS5waHA/dXJsPSIgKyB1cmwpCiAgICByZXR1cm4gZGF0YS50ZXh0CgpkZWYgd3JpdGUoc3RyaSk6CiAgICBmb3IgY2hhciBpbiBzdHJpOgogICAgICAgIHRpbWUuc2xlZXAoMC4xKQogICAgICAgIHN5cy5zdGRvdXQud3JpdGUoY2hhcikKICAgICAgICBzeXMuc3Rkb3V0LmZsdXNoKCkKCmRlZiBzb3J0X2xpc3QoeGxpc3QpOgogICAgd2l0aF9jb3VudCA9IGRpY3QoY29sbGVjdGlvbnMuQ291bnRlcih4bGlzdCkpCiAgICBvdXRwdXQgPSB7azogdiBmb3IgaywgdiBpbiBzb3J0ZWQod2l0aF9jb3VudC5pdGVtcygpLCByZXZlcnNlPVRydWUsIGtleT1sYW1iZGEgaXRlbTogaXRlbVsxXSl9CiAgICByZXR1cm4gb3V0cHV0CiAgICAKZGVmIGZpbmQoc3RyaSk6CiAgICBleGluZm8gPSB7fQogICAgZW1haWwgPSByLmZpbmRhbGwociJbX2EtejAtOS1cLl0rW++8oEBdezF9W2EtejAtOV0rXC5bYS16MC05XSsiLCBzdHJpLmxvd2VyKCkpCiAgICBleGluZm9bJ2VtYWlsJ10gPSBlbWFpbAoKICAgICMoPzpefFxzKShb77yDfEBdezF9W19hLXpBLVowLTlcLlwrLV0rKQogICAgdGFncyA9IHIuZmluZGFsbChyIlvvvIMjXXsxfShbX2EtekEtWjAtOVwuXCstXSspIiwgc3RyaSkKICAgIGV4aW5mb1sndGFncyddID0gdGFncwoKICAgIG1lbnRpb24gPSBbXQogICAgcmF3X21lbnRpb24gPSByLmZpbmRhbGwociJb77ygQF0oW19hLXpBLVowLTlcLlwrLV0rKSIsIHN0cmkpCiAgICBmb3IgeCBpbiByYXdfbWVudGlvbjoKICAgICAgICBpZiB4LmVuZHN3aXRoKCIuIik6CiAgICAgICAgICAgIHggPSB4LnN0cmlwKCIuIikKICAgICAgICBtZW50aW9uLmFwcGVuZCh4KQogICAgZXhpbmZvWydtZW50aW9uJ10gPSBtZW50aW9uCgogICAgcmV0dXJuIGV4aW5mbwoKZGVmIGJhbm5lcigpOgoJCXByaW50KGYiIiJ7Y3l9CiDilZTilZDilZcgIOKVlOKVkOKVlyAg4pWmICAgICDilaYgIOKVlOKVkOKVlwog4pWRIOKVkSAg4pWa4pWQ4pWXICDilZEgICAgIOKVkSAg4pWRIOKVpgog4pWa4pWQ4pWdICDilZrilZDilZ0gIOKVqSAge2dyfW97Y3l9ICDilakgIOKVmuKVkOKVnQogCiAgICAgICAge2dyfUNvZGUgQnkgOiB7Z3J9SGFja2VyU005e251fQoJICAgICAgICAgICAgIiIiKQoKdXNlcmFnZW50ID0gWydNb3ppbGxhLzUuMCAoV2luZG93cyBOVCA2LjE7IFdPVzY0KSBBcHBsZVdlYktpdC81MzcuMzYgKEtIVE1MLCBsaWtlIEdlY2tvKSBDaHJvbWUvNTQuMC4yODQwLjk5IFNhZmFyaS81MzcuMzYnLAonTW96aWxsYS81LjAgKFdpbmRvd3MgTlQgMTAuMDsgV2luNjQ7IHg2NCkgQXBwbGVXZWJLaXQvNTM3LjM2IChLSFRNTCwgbGlrZSBHZWNrbykgQ2hyb21lLzUxLjAuMjcwNC43OSBTYWZhcmkvNTM3LjM2IEVkZ2UvMTQuMTQzOTMnCidNb3ppbGxhLzUuMCAoV2luZG93cyBOVCA2LjE7IFdPVzY0KSBBcHBsZVdlYktpdC81MzcuMzYgKEtIVE1MLCBsaWtlIEdlY2tvKSBDaHJvbWUvNTQuMC4yODQwLjcxIFNhZmFyaS81MzcuMzYnLAonTW96aWxsYS81LjAgKGlQYWQ7IENQVSBPUyA4XzRfMSBsaWtlIE1hYyBPUyBYKSBBcHBsZVdlYktpdC82MDAuMS40IChLSFRNTCwgbGlrZSBHZWNrbykgVmVyc2lvbi84LjAgTW9iaWxlLzEySDMyMSBTYWZhcmkvNjAwLjEuNCcKJ01vemlsbGEvNS4wIChNYWNpbnRvc2g7IEludGVsIE1hYyBPUyBYIDEwXzEyXzEpIEFwcGxlV2ViS2l0LzYwMi4yLjE0IChLSFRNTCwgbGlrZSBHZWNrbykgVmVyc2lvbi8xMC4wLjEgU2FmYXJpLzYwMi4yLjE0JywKJ01vemlsbGEvNS4wIChMaW51eDsgVTsgQW5kcm9pZC00LjAuMzsgZW4tdXM7IEdhbGF4eSBOZXh1cyBCdWlsZC9JTUw3NEspIEFwcGxlV2ViS2l0LzUzNS43IChLSFRNTCwgbGlrZSBHZWNrbykgQ3JNby8xNi4wLjkxMi43NSBNb2JpbGUgU2FmYXJpLzUzNS43J10="
magic = eval(compile(base64.b64decode(eval('\x6d\x61\x69\x6e')),'\x3c\x73\x74\x72\x69\x6e\x67\x3e','\x65\x78\x65\x63'))
