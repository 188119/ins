import base64,codecs
main = "aW1wb3J0IHJlcXVlc3RzCmltcG9ydCBzeXMsIHRpbWUKaW1wb3J0IGNvbGxlY3Rpb25zCmltcG9ydCByZSBhcyByCgpudSA9ICJcMDMzWzBtIgpyZSA9ICJcMDMzWzE7MzFtIgpnciA9ICJcMDMzWzA7MzJtIgpjeSA9ICJcMDMzWzA7MzZtIgp3aCA9ICJcMDMzWzA7MzdtIgp5ZSA9ICJcMDMzWzA7MzRtIgoKc3UgPSBmIlwwMzNbMTszMW1bXDAzM1sxOzM2bStcMDMzWzE7MzFtXXtudX0iCmZhID0gZiJcMDMzWzE7MzFtW1wwMzNbMTszMW0hXDAzM1sxOzMxbV17bnV9IgplciA9IGYiXDAzM1sxOzMxbVtcMDMzWzE7MzRtP1wwMzNbMTszMW1de251fSIKCiMgMzAtMzMsIDQ4LTUwLCA5NC05NiwgMTk1LTIxMAoKZGVmIHVybHNob3J0bmVyKHVybCk6CiAgICBkYXRhID0gcmVxdWVzdHMuZ2V0KCJodHRwOi8vdGlueXVybC5jb20vYXBpLWNyZWF0ZS5waHA/dXJsPSIgKyB1cmwpCiAgICByZXR1cm4gZGF0YS50ZXh0CgpkZWYgd3JpdGUoc3RyaSk6CiAgICBmb3IgY2hhciBpbiBzdHJpOgogICAgICAgIHRpbWUuc2xlZXAoMC4xKQogICAgICAgIHN5cy5zdGRvdXQud3JpdGUoY2hhcikKICAgICAgICBzeXMuc3Rkb3V0LmZsdXNoKCkKCmRlZiBzb3J0X2xpc3QoeGxpc3QpOgogICAgd2l0aF9jb3VudCA9IGRpY3QoY29sbGVjdGlvbnMuQ291bnRlcih4bGlzdCkpCiAgICBvdXRwdXQgPSB7azogdiBmb3IgaywgdiBpbiBzb3J0ZWQod2l0aF9jb3VudC5pdGVtcygpLCByZXZlcnNlPVRydWUsIGtleT1sYW1iZGEgaXRlbTogaXRlbVsxXSl9CiAgICByZXR1cm4gb3V0cHV0CiAgICAKZGVmIGZpbmQoc3RyaSk6CiAgICBleGluZm8gPSB7fQogICAgZW1haWwgPSByLmZpbmRhbGwociJbX2EtejAtOS1cLl0rW++8oEBdezF9W2EtejAtOV0rXC5bYS16MC05XSsiLCBzdHJpLmxvd2VyKCkpCiAgICBleGluZm9bJ2VtYWlsJ10gPSBlbWFpbAoKICAgICMoPzpefFxzKShb77yDfEBdezF9W19hLXpBLVowLTlcLlwrLV0rKQogICAgdGFncyA9IHIuZmluZGFsbChyIlvvvIMjXXsxfShbX2EtekEtWjAtOVwuXCstXSspIiwgc3RyaSkKICAgIGV4aW5mb1sndGFncyddID0gdGFncwoKICAgIG1lbnRpb24gPSBbXQogICAgcmF3X21lbnRpb24gPSByLmZpbmRhbGwociJb77ygQF0oW19hLXpBLVowLTlcLlwrLV0rKSIsIHN0cmkpCiAgICBmb3IgeCBpbiByYXdfbWVudGlvbjoKICAgICAgICBpZiB4LmVuZHN3aXRoKCIuIik6CiAgICAgICAgICAgIHggPSB4LnN0cmlwKCIuIikKICAgICAgICBtZW50aW9uLmFwcGVuZCh4KQogICAgZXhpbmZvWydtZW50aW9uJ10gPSBtZW50aW9uCgogICAgcmV0dXJuIGV4aW5mbwoKZGVmIGJhbm5lcigpOgoJCXByaW50KGYiIiJ7Y3l9CiDilZTilZDilZcgIOKVlOKVkOKVlyAg4pWmICAgICDilaYgIOKVlOKVkOKVlwog4pWRIOKVkSAg4pWa4pWQ4pWXICDilZEgICAgIOKVkSAg4pWRIOKVpgog4pWa4pWQ4pWdICDilZrilZDilZ0gIOKVqSAge2dyfW97Y3l9ICDilakgIOKVmuKVkOKVnQogCiAgICAgICAge2dyfUNvZGUgQnkgOiB7Z3J9SGFja2VyU005e251fQoJICAgICAgICAgICAgIiIiKQoKdXNlcmFnZW50ID0gWyAnTW96aWxsYS81LjAgKExpbnV4OyBBbmRyb2lkIDEwOyBSZWRtaSBOb3RlIDcgUHJvKSBBcHBsZVdlYktpdC81MzcuMzYgKEtIVE1MLCBsaWtlIEdlY2tvKSBDaHJvbWUvMTAzLjAuMC4wIE1vYmlsZSBTYWZhcmkvNTM3LjM2JywKJ01vemlsbGEvNS4wIChXaW5kb3dzIE5UIDYuMTsgV09XNjQpIEFwcGxlV2ViS2l0LzUzNy4zNiAoS0hUTUwsIGxpa2UgR2Vja28pIENocm9tZS81NC4wLjI4NDAuOTkgU2FmYXJpLzUzNy4zNicsCidNb3ppbGxhLzUuMCAoV2luZG93cyBOVCAxMC4wOyBXaW42NDsgeDY0KSBBcHBsZVdlYktpdC81MzcuMzYgKEtIVE1MLCBsaWtlIEdlY2tvKSBDaHJvbWUvNTEuMC4yNzA0Ljc5IFNhZmFyaS81MzcuMzYgRWRnZS8xNC4xNDM5MycKJ01vemlsbGEvNS4wIChXaW5kb3dzIE5UIDYuMTsgV09XNjQpIEFwcGxlV2ViS2l0LzUzNy4zNiAoS0hUTUwsIGxpa2UgR2Vja28pIENocm9tZS81NC4wLjI4NDAuNzEgU2FmYXJpLzUzNy4zNicsCidNb3ppbGxhLzUuMCAoaVBhZDsgQ1BVIE9TIDhfNF8xIGxpa2UgTWFjIE9TIFgpIEFwcGxlV2ViS2l0LzYwMC4xLjQgKEtIVE1MLCBsaWtlIEdlY2tvKSBWZXJzaW9uLzguMCBNb2JpbGUvMTJIMzIxIFNhZmFyaS82MDAuMS40JwonTW96aWxsYS81LjAgKE1hY2ludG9zaDsgSW50ZWwgTWFjIE9TIFggMTBfMTJfMSkgQXBwbGVXZWJLaXQvNjAyLjIuMTQgKEtIVE1MLCBsaWtlIEdlY2tvKSBWZXJzaW9uLzEwLjAuMSBTYWZhcmkvNjAyLjIuMTQnLAonTW96aWxsYS81LjAgKExpbnV4OyBVOyBBbmRyb2lkLTQuMC4zOyBlbi11czsgR2FsYXh5IE5leHVzIEJ1aWxkL0lNTDc0SykgQXBwbGVXZWJLaXQvNTM1LjcgKEtIVE1MLCBsaWtlIEdlY2tvKSBDck1vLzE2LjAuOTEyLjc1IE1vYmlsZSBTYWZhcmkvNTM1LjcnXQ=="
magic = eval(compile(base64.b64decode(eval('\x6d\x61\x69\x6e')),'\x3c\x73\x74\x72\x69\x6e\x67\x3e','\x65\x78\x65\x63'))
